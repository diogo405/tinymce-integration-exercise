<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /*.tox {display: none;}*/
  </style>
  <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

  <!-- TODO font toolbar item; styleselect customisation -->
  <script>
    const dialogConfig = {
      title: 'Beautify',
      body: {
        type: 'panel',
        items: [
          {
            type: 'input',
            name: 'uglyText',
            label: 'Enter text that you want to be beautiful'
          }
        ]
      },
      buttons: [
        {
          type: 'cancel',
          name: 'closeButton',
          text: 'Cancel'
        },
        {
          type: 'submit',
          name: 'submitButton',
          text: 'Beautify',
          primary: true
        }
      ],
      onSubmit: function (api) {
        const data = api.getData();
        tinymce.activeEditor.execCommand('mceInsertContent', false, `<span class="beautiful">${data.uglyText}</span>`);
        api.close();
      }
    };

    tinymce.init({
      selector: '#mytextarea',
      plugins: 'insertdatetime code table lists fullscreen wordcount print link image autoresize',
      toolbar: `
        undo redo | 
        bold italic | 
        alignleft aligncenter alignright alignjustify | 
        fontselect fontsizeselect styleselect | 
        bullist numlist outdent indent | 
        link image |
        fullscreen wordcount code print |
        _beautify
      `,
      content_style: `
        body { 
          font-size: 14pt 
        }
        .beautiful {     
          background-color: #ffba08;
          color: black;
          padding: 1px 4px;
          border-radius: 4px; 
        }
      `,
      formats: {
        beautiful: { inline: 'span', classes: 'beautiful' }
      },
      style_formats: [
        { title: 'Heading 1', format: 'h1' },
        { title: 'Heading 2', format: 'h2' },
        { title: 'Heading 3', format: 'h3' },
        { title: 'Heading 4', format: 'h4' },
        { title: 'Heading 5', format: 'h5' },
        { title: 'Heading 6', format: 'h6' },
        { title: 'Preformatted', format: 'pre' },
        { title: 'Beautiful', format: 'beautiful' },
      ],
      setup: function (editor) {
        editor.ui.registry.addButton('_beautify', {
          icon: 'brightness',
          tooltip: 'Make it beautiful',
          onAction: function () {
            editor.windowManager.open(dialogConfig);
          }
        });
      }
    });
  </script>

</head>

<body>
  <h1>TinyMCE Classic</h1>
  <form method="post">
    <textarea id="mytextarea"></textarea>
  </form>
</body>

</html>